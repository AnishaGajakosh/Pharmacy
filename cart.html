<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Cart - CareKart</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header class="site-header">
    <div class="container header-inner">
      <a class="logo" href="index.html"> CareKart </a>
      <div class="titlebar">Trusted medicines, delivered fast</div>
    </div>
  </header>

  <main class="container">
    <a href="index.html" class="back-arrow">‚Üê Back</a>
    <h1>Your Cart</h1>
    <div id="cartList" class="cart-list"></div>
    <div class="cart-actions">
      <div id="totalPrice">Total: ‚Çπ 0.00</div>
      <div class="action-buttons">
        <a id="checkoutLink" href="checkout.html" class="btn-add disabled">Proceed to Checkout</a>
        <button id="clearCartBtn" class="btn-clear disabled">Clear Cart</button>
      </div>
    </div>
  </main>

  <script>
    const cartList = document.getElementById('cartList');
    let cart = JSON.parse(localStorage.getItem('cart') || '[]');
    const checkoutLink = document.getElementById("checkoutLink");
    const clearCartBtn = document.getElementById("clearCartBtn");
    const totalPrice = document.getElementById("totalPrice");

    function render(){ 
      cartList.innerHTML=''; 
      let total=0; 

      if(cart.length === 0){
        cartList.innerHTML = `<p style="font-size:18px;color:#555;text-align:center;margin-top:20px">
          üõí Your cart is empty.
        </p>`;
        totalPrice.textContent = "Total: ‚Çπ 0.00";
        checkoutLink.classList.add("disabled");
        clearCartBtn.classList.add("disabled");
        return;
      }

      checkoutLink.classList.remove("disabled");
      clearCartBtn.classList.remove("disabled");

      cart.forEach((it,idx)=>{ 
        total += (it.price||0)*it.quantity; 
        const d=document.createElement('div'); 
        d.className='cart-item'; 
        d.innerHTML = `
          <div class="cart-row">
            <div class="cart-left">
              <div class="cart-name">${it.name}</div>
              <div class="cart-price">‚Çπ ${Number(it.price||0).toFixed(2)}</div>
            </div>
            <div class="cart-right">
              <input type="number" min="1" value="${it.quantity}" data-idx="${idx}" class="qty">
              <button data-idx="${idx}" class="btn-remove">Remove</button>
            </div>
          </div>`;
        cartList.appendChild(d);
      });

      totalPrice.textContent = `Total: ‚Çπ ${total.toFixed(2)}`;
      localStorage.setItem('cart', JSON.stringify(cart));
    }

    render();

    cartList.addEventListener('click', e=>{
      if(e.target.matches('.btn-remove')){ 
        const idx = Number(e.target.dataset.idx); 
        cart.splice(idx,1); 
        render(); 
      }
    });

    cartList.addEventListener('change', e=>{
      if(e.target.matches('.qty')){ 
        const idx=Number(e.target.dataset.idx); 
        cart[idx].quantity = Number(e.target.value); 
        render(); 
      }
    });

    checkoutLink.addEventListener("click", function(e) {
      cart = JSON.parse(localStorage.getItem("cart") || "[]");
      if (cart.length === 0) {
        e.preventDefault();
        alert("Your cart is empty! Add items before proceeding to checkout.");
      }
    });

    clearCartBtn.addEventListener("click", function() {
      if (cart.length > 0 && confirm("Are you sure you want to clear the cart?")) {
        cart = [];
        localStorage.setItem("cart", JSON.stringify(cart));
        render();
      }
    });
  </script>

  <style>
    .back-arrow {display: inline-block;font-size: 22px;cursor: pointer;margin-bottom: 15px;color: #28a745;text-decoration: none;font-weight: 500;}
    .back-arrow:hover { color: #1e7e34; }
    .logo {display: flex;align-items: center;gap: 10px;text-decoration: none;font-weight: 700;font-size: 50px;color: var(--primary-dark);}
    
    .cart-actions {margin-top: 14px;display: flex;justify-content: space-between;align-items: center;}
    .action-buttons {display: flex;gap: 10px;}
    .btn-add {background:#28a745;color:#fff;padding:10px 16px;border-radius:6px;text-decoration:none;font-weight:600;}
    .btn-add:hover { background:#218838; }
    .btn-add.disabled {background: #ccc;pointer-events: none;cursor: not-allowed;}

    .btn-clear {background:#dc3545;color:#fff;padding:10px 16px;border-radius:6px;border:none;font-weight:600;cursor:pointer;}
    .btn-clear:hover { background:#c82333; }
    .btn-clear.disabled {background:#ccc;pointer-events:none;cursor:not-allowed;}

    .cart-item {margin-bottom: 10px;}
    .cart-row {display: flex;justify-content: space-between;align-items: center;padding: 12px 0;border-bottom: 1px solid #eee;}
    .cart-left {display: flex;flex-direction: column;gap: 4px;}
    .cart-name {font-weight: 700;}
    .cart-price {font-size: 12px;color: #666;}
    .cart-right {display: flex;gap: 10px;align-items: center;}
    .qty {width: 70px;padding: 6px;border: 1px solid #ccc;border-radius: 4px;}
    .btn-remove {background: #dc3545;color: #fff;padding: 6px 12px;border: none;border-radius: 4px;cursor: pointer;font-size: 14px;}
    .btn-remove:hover {background: #c82333;}
  </style>

  <footer class="site-footer">
    <p>¬© 2025 CareKart. All rights reserved.</p>
  </footer>
</body>
</html>
