<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
  <title>My Orders - A1 Medical</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
<main class="container">
  <h1>My Orders</h1>
  <div id="ordersList"></div>
</main>

<script>
  async function loadOrders() {
    try {
      const res = await fetch("/api/orders", {
        headers: { Authorization: "Bearer " + localStorage.getItem("token") }
      });
      const data = await res.json();
      if (!data.ok) return alert("Failed to load orders");

      const list = document.getElementById("ordersList");
      list.innerHTML = "";

      data.orders.forEach(o => {
        const div = document.createElement("div");
        div.className = "order";

        // Payment details if available
        let paymentDetails = "";
        if (o.payment) {
          paymentDetails = `
            <p><strong>Payment ID:</strong> ${o.payment.razorpayPaymentId || "—"}</p>
            <p><strong>Payment Status:</strong> ${o.payment.status}</p>
            <p><strong>Amount:</strong> ₹${(o.payment.amount || 0) / 100}</p>
          `;
        }

        div.innerHTML = `
          <h3>Order #${o._id}</h3>
          <p><strong>Status:</strong> ${o.status}</p>
          <p><strong>Payment Method:</strong> ${o.paymentMethod}</p>
          ${paymentDetails}
          <h4>Items:</h4>
          <ul>
            ${o.items.map(i => `<li>${i.name} x${i.quantity} - ₹${i.price}</li>`).join("")}
          </ul>
        `;
        list.appendChild(div);
      });
    } catch (err) {
      console.error(err);
      alert("Error loading orders");
    }
  }
  loadOrders();
</script>

<style>
.container{max-width:700px;margin:30px auto}
.order{border:1px solid #ddd;padding:15px;margin-bottom:15px;border-radius:8px;background:#fff}
.order h3{margin-top:0}
</style>
</body>
</html>
